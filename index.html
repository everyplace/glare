<!DOCTYPE html>
<html>
	<head>
		<title>Accelerometer Demo</title>
		<script src="jquery-latest.js"></script>
		<meta name="viewport" content="width=device-width, user-scalable=no" />
		<script src="scripts.js"></script>
		<script>
			$(document).ready(function(){

				$(window).on("devicemotion", function(error){
			                   
			        var backgroundPositionXOffset = ((event.accelerationIncludingGravity.x + 10)/20).toString().substring(0,4);
			        	backgroundPositionXOffset = 1 - backgroundPositionXOffset;
			        var backgroundPositionYOffset = ((event.accelerationIncludingGravity.y + 10)/20).toString().substring(0,4);
			        var backgroundPositionZOffset = (((event.accelerationIncludingGravity.z + 10)/20) * 100).toString().substring(0,4);




			        var x = backgroundPositionXOffset;
			       	var modifiedX = (4 * x * x * x) - (6 * x * x) + (3 * x);
			       	//var modifiedX = (((x * 2) - 1) * Math.square(((x * 2) - 1)) + 1)/2;

			        var y = backgroundPositionYOffset;
					var modifiedY = 
						(1/2) + 
						(0.205 * ((2 * y) - 1)) * 
						(	4 
							- 
							(
								(
									Math.pow(
										Math.pow(
											(((14*y) -7) /10),2
										), (1/3)
									)
								)
							) 
							- 
							(
								2 *(
									(
										Math.pow(
											Math.pow(
												(((14*y) -7) /10),8
											), (1/3)
										)
									)
								)
							) 
						)

					;

					var modifiedXa = modifiedX;
					var modifiedXb = modifiedXa - ((3 * modifiedXa) / 3) * (1 - modifiedXa);
					var modifiedXc = modifiedXa + ((3 * modifiedXa) / 3) * (1 - modifiedXa);

					var modifiedYa = modifiedY;
					var modifiedYb = modifiedYa - ((3 * modifiedYa) / 3) * (1 - modifiedYa);
					var modifiedYc = modifiedYa + ((3 * modifiedYa) / 3) * (1 - modifiedYa);

					//eliminate extreme errant values of greater than 1 or less than 0 values
					modifiedXb = (modifiedXb < 0) ? 0 : modifiedXb;
					modifiedXc = (modifiedXc > 1) ? 1 : modifiedXc;
					modifiedYb = (modifiedYb < 0) ? 0 : modifiedYb;
					modifiedYc = (modifiedYc > 1) ? 1 : modifiedYc;
					



			        var rgbString = "0,0,0";
			        var stopAlpha = ".15";

			        var width = $(window).width();
			        var height = $(window).height();
			        var intersectionX = width * modifiedX;
			        var intersectionY = height * modifiedY;
			        var stopRadialPercentage = modifiedX * 100;


			        if(stopRadialPercentage > 50) {
			        	stopRadialPercentage = 100 - stopRadialPercentage;
			        }




			        $('body').css(
			        	{
			        		'-webkitMaskImage': "-webkit-gradient(linear, left top, left bottom, color-stop(0, rgba("+rgbString+",0)), color-stop("+modifiedYb+", rgba("+rgbString+","+stopAlpha+")), color-stop("+modifiedYa+", rgba("+rgbString+",1)), color-stop("+modifiedYc+", rgba("+rgbString+","+stopAlpha+")), color-stop(1, rgba("+rgbString+",0))),-webkit-gradient(linear, left bottom, right bottom, color-stop(0, rgba("+rgbString+",0)), color-stop("+modifiedXb+", rgba("+rgbString+","+stopAlpha+")), color-stop("+modifiedX+", rgba("+rgbString+",1)), color-stop("+modifiedXc+", rgba("+rgbString+","+stopAlpha+")), color-stop(1, rgba("+rgbString+",0))), -webkit-radial-gradient("+intersectionX+"px "+intersectionY+"px, ellipse cover, rgba(0,0,0,1) 0%,rgba(0,0,0,0) "+stopRadialPercentage+"%,rgba(0,0,0,0) 95%, rgba(255,255,255,1) 100%)"
			        	}
			        );

			        $("#data").html(
			        	"x-axis: " + modifiedX + "<br />" +
			        	"y-axis: " + modifiedY + "<br />" +
			        	"z-axis: " + backgroundPositionZOffset + "<br />" +
			        	"yb: " + modifiedYb + "<br />" +
			        	"ya: " + modifiedYa + "<br />" +
			        	"yc: " + modifiedYc + "<br />" +
			        	"intX: " + stopRadialPercentage
			        );


			        	

				});

			});
		</script>
		<style>
			
			* {	margin:0; padding:0; }
			html{ min-height:100%; background-color:red; }

			body {
				
				background-color:white;
				min-height:1280px;
			}

			#data {
				background-color:white;
			}
		</style>
	</head>
	<body>

		<div id="data" >0</div>

		<img src="beautyshop.jpg" width="320" height="auto"/> 
		<div id="track"></div>

	</body>
</html>
