<!DOCTYPE html>
<html>
	<head>
		<title>Accelerometer 3D Demo</title>
		<script src="jquery-latest.js"></script>
		<meta name="viewport" content="width=320, user-scalable=no" />
		<script>
			$(document).ready(function(){
				
				//http://gotochriswest.com/blog/2011/05/06/cube-root-an-beyond/
				var nthroot = function (x, n) {
				  try {
				    var negate = n % 2 == 1 && x < 0;
				    if(negate)
				      x = -x;
				    var possible = Math.pow(x, 1 / n);
				    n = Math.pow(possible, n);
				    if(Math.abs(x - n) < 1 && (x > 0 == n > 0))
				      return negate ? -possible : possible;
				  } catch(e){}
				};

				$(window).on("devicemotion", function(error){

			        var backgroundPositionXOffset = ((event.accelerationIncludingGravity.x + 10)/20).toString().substring(0,4);
			        var backgroundPositionXOffsetSqrt = Math.sqrt(((event.accelerationIncludingGravity.x + 10)/20)).toString().substring(0,4);
			        var backgroundPositionYOffset = ((event.accelerationIncludingGravity.y + 10)/20).toString().substring(0,4);
			        var backgroundPositionYOffsetSqrt = Math.sqrt(((event.accelerationIncludingGravity.y + 10)/20)).toString().substring(0,4);
			        var backgroundPositionZOffset = (((event.accelerationIncludingGravity.z + 10)/20) * 100).toString().substring(0,4);

			        var x = backgroundPositionXOffset;
			       	var modifiedX = (4 * x * x * x) - (6 * x * x) + (3 * x);
			       	//var modifiedX = (((x * 2) - 1) * Math.square(((x * 2) - 1)) + 1)/2;

			        var y = backgroundPositionYOffset;
					var modifiedY = (nthroot(((2 * y) - 1), 3) + 1) /2;


			        var rgbString = "0,0,0";

			        $('body').css(
			        	{
			        		'-webkitMaskImage': "-webkit-gradient(linear, left top, left bottom, color-stop(0, rgba("+rgbString+",0)), color-stop("+modifiedY+", rgba("+rgbString+",1)), color-stop(1, rgba("+rgbString+",0))),-webkit-gradient(linear, left bottom, right bottom, color-stop(0, rgba("+rgbString+",0)), color-stop("+modifiedX+", rgba("+rgbString+",1)), color-stop(1, rgba("+rgbString+",0)))",
       						'-webkitTransform': "perspective(320px) rotate3d(1,0,0, "+(backgroundPositionZOffset * (18/10))+"deg)"
			        	}
			        );


			        


			        $("#placeholder").html(
			        	"x-axis: " + backgroundPositionXOffset + "<br />" +
			        	"y-axis: " + backgroundPositionYOffset + "<br />" +
			        	"z-axis: " + backgroundPositionZOffset + "<br />"
			        );
	

			     });

			});
		</script>
		<style>
			
			* {	margin:0; padding:0; }
			html{ min-height:100%; }

			body {
				
				width:320px;
				min-height:480px;

			}

			#placeholder {
				position:absolute;
				top:0;
				left:0;
				text-align: center;
				width:320px;
				height:320px;
				background-color:red;
				-webkit-transition:-webkit-transform .1s;
				-webkit-transform-origin:0 0 0;
			}

		</style>
	</head>
	<body>

		<h2 id="counter">0</h2>
		<h2 id="placeholder">0</h2>

	</body>
</html>